<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<style type="text/css">
h1 { font-family: sans-serif; font-size: 200%; }
h2 { font-family: sans-serif; font-size: 140%; }
h3 { font-family: sans-serif; font-size: 105%; }
h4 { font-family: serif; font-size: 100%; }
a:link { color: darkgreen; }
a:visited { color: darkslategray; }
a:hover { color: red; }
body { margin: 18px 16px 8px 16px; padding: 0px; }
</style>
<title>Zeta &mdash; computing zeta functions of groups, algebras,
and modules</title>
<meta http-equiv="content-type" content=
"text/html; charset=us-ascii">
<meta name="author" content="Tobias Rossmann">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
	src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> 
</script>
</head>
<body>
<pre>
ZZZZZZZZZZZZZZZZZZZ                           tttt                           
Z:::::::::::::::::Z                        ttt:::t                           
Z:::::::::::::::::Z                        t:::::t                           
Z:::ZZZZZZZZ:::::Z                         t:::::t                           
ZZZZZ     Z:::::Z     eeeeeeeeeeee   ttttttt:::::ttttttt     aaaaaaaaaaaaa   
        Z:::::Z     ee::::::::::::ee t:::::::::::::::::t     a::::::::::::a  
       Z:::::Z     e::::::eeeee:::::et:::::::::::::::::t     aaaaaaaaa:::::a 
      Z:::::Z     e::::::e     e:::::tttttt:::::::tttttt              a::::a 
     Z:::::Z      e:::::::eeeee::::::e     t:::::t             aaaaaaa:::::a 
    Z:::::Z       e:::::::::::::::::e      t:::::t           aa::::::::::::a 
   Z:::::Z        e::::::eeeeeeeeeee       t:::::t          a::::aaaa::::::a 
ZZZ:::::Z     ZZZZe:::::::e                t:::::t    ttttta::::a    a:::::a 
Z::::::ZZZZZZZZ:::e::::::::e               t::::::tttt:::::a::::a    a:::::a 
Z:::::::::::::::::Ze::::::::eeeeeeee       tt::::::::::::::a:::::aaaa::::::a 
Z:::::::::::::::::Z ee:::::::::::::e         tt:::::::::::tta::::::::::aa:::a
ZZZZZZZZZZZZZZZZZZZ   eeeeeeeeeeeeee           ttttttttttt   aaaaaaaaaa  aaaa

                                                                Version 0.4.2
                             by
                                 <a href="https://torossmann.github.io">Tobias Rossmann</a>
  
</pre>
<hr>
<h1>Contents</h1>
<ol>
<li><a href="#description">Description</a></li>
<li><a href="#download">Download and setup</a>
  <ol>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#installation">Installation</a></li>
    <li><a href="#releases">Releases</a></li>
  </ol>
</li>
<li><a href="#usage">Basic usage</a>
<ol>
<li><a href="#algebras">Creating algebras</a></li>
<li><a href="#top">Computing topological zeta functions</a></li>
<li><a href="#pad">Computing local zeta functions</a></li>
<li><a href="#igusa">Computing Igusa-type zeta functions</a></li>
<li><a href="#modules">Modules and algebras with operators</a></li>
<li><a href="#average">Average sizes of kernels</a></li>
<li><a href="#conjugacy">Conjugacy class zeta functions</a></li>
<li><a href="#graphs">Graphs and hypergraphs</a></li>
<li><a href="#cntpts">Counting rational points</a></li>
</ol>
</li>
<li><a href="#db">The built-in database of examples</a>
  <ol>
  <li><a href="#access">Accessing the database</a></li>
  <li><a href="#names">Algebras and their names</a></li>
  <li><a href="#listing">Listing algebras, topological zeta functions, and their
  properties</a></li>
  </ol>
</li>
<li><a href="#advanced">Advanced usage</a>
<ol>
  <li><a href="#creation">More on the creation of algebras</a></li>
  <li><a href="#blocks">Additive gradings: blocks</a></li>
  <li><a href="#bases">Changing bases</a></li>
  <li><a href="#verbose">Verbosity</a></li>
  <li><a href="#cost">Computational resources</a></li>
</ol>
</li>
<li><a href="#references">References</a></li>
<li><a href="#funding">Funding</a></li>
<li><a href="#acknowledgements">Acknowledgements</a></li>
<li><a href="#license">License</a></li>
<li><a href="#contact">Contact</a></li>
</ol>
<!--====================================================================-->
<h1 id="description">1. Description</h1>
<!--====================================================================-->
<p>Zeta provides methods for computing local and topological zeta functions
  arising from the enumeration of subalgebras, ideals, submodules,
  representations, and conjugacy classes of suitable algebraic structures,
  as well as some other types of zeta functions.
  For theoretical background and descriptions of the 
  methods used, see
  [<a href="#topzeta">1</a>,
  <a href="#topzeta2">2</a>,
  <a href="#unipotent">3</a>,
  <a href="#padzeta">4</a>,
  <a href="#ask">5</a>,
  <a href="#ask2">6</a>,
  <a href="#cico">7</a>].
  Zeta is distributed as a <a href="http://www.python.org">Python</a>-package
  for the computer algebra system <a href="http://sagemath.org/">SageMath</a>.
  In addition to <a href="https://www.singular.uni-kl.de">Singular</a> and other
  software included with Sage, Zeta also relies on
  <a href="https://www.math.ucdavis.edu/~latte/software.php">LattE integrale</a>
  and <a href="https://www.normaliz.uni-osnabrueck.de/">Normaliz</a>.
</p>

<!--====================================================================-->
<h1 id="download">2. Download and setup</h1>
<!--====================================================================-->
<!--====================================================================-->
<h2 id="requirements">2.1 Requirements</h2>
<!--====================================================================-->
<p>This software requires a recent version
  of <a href="http://sagemath.org/">SageMath</a>.
  Zeta 0.4.2 has been developed for Sage 9.2
  on 64-bit Linux (x86_64) systems; other platforms and versions of
  Sage may or may not work as expected.</p>
<!--====================================================================-->
<h2 id="installation">2.2 Installation</h2>
<!--====================================================================-->

<p>
  The (sources of the) most recent version of Zeta are available as
  a <a href="https://github.com/torossmann/Zeta">public repository</a> on
  <a href="https://github.com/">GitHub</a>.</p>

<p>
On a 64-bit Linux (x86_64) system, the easiest way to
install Zeta is to download 
<a href="https://torossmann.github.io/Zeta/Zeta-0.4.2-x86_64.tar.bz2">
this archive</a> and extract it into some directory,
<code>$DIR</code> say.
This will create a subdirectory
<code>$DIR/Zeta</code>;
please make sure that any previous version of Zeta is removed beforehand.
Next, you will then have to run <code>make</code> from within <code>$DIR/Zeta</code>.</p>

<p>If Sage is started from within
<code>$DIR</code> or if <code>$DIR</code> is among the directories
listed in <code>$SAGE_PATH</code>, then Zeta can be imported
via</p>
<pre><code>        import Zeta
</code></pre>
<p>If <code>$DIR</code> is not listed in <code>$SAGE_PATH</code>,
you can permanently include it by adding a line</p>
<pre><code>        export SAGE_PATH="$DIR:$SAGE_PATH"
</code></pre>
<p>to <code>$HOME/.bashrc</code> (if you use bash), where
<code>$DIR</code> is replaced by the actual directory name from
above; having applied this change, you will want to start a new
shell. Alternatively, for a temporary solution, after executing</p>
<pre><code>        sys.path.append('$DIR')
</code></pre>
<p>from within Sage, you should be able to import Zeta.</p>

<p>During its operation, Zeta will try to invoke the 
  programs <code>count</code> (a part of <a href="https://www.math.ucdavis.edu/~latte/software.php">LattE integrale</a>),
  <code>scdd_gmp</code> (part
  of <a href="https://www.inf.ethz.ch/personal/fukudak/cdd_home/">cddlib</a>
  and also bundled with LattE integrale),
  and <a href="https://www.normaliz.uni-osnabrueck.de/"><code>normaliz</code></a>.
  These programs should be placed inside <code>$DIR/Zeta/bin</code>; copies are
  included with the archive linked to above.</p>
<p>Zeta requires a patched version of <code>count</code>.
  To that end, the file <code>latte-int-1.7.3/code/latte/genFunction/maple.cpp</code>
  in the sources of LattE integrale 1.7.3 should be replaced by the
  file <code>maple.cpp</code> included with Zeta.
  In order to compile the patched version of LattE integrale 1.7.3 from
  scratch, you may want to
  use <a href="https://torossmann.github.io//Zeta/latte-integrale-1.7.3-for-Zeta.tar">this
  modified version</a> 
  (26M) of the LattE integrale 1.7.3 bundle.
</p> 

<!--====================================================================-->
<h1 id="usage">3. Basic usage</h1>
<!--====================================================================-->
<!--====================================================================-->
<h2 id="algebras">3.1. Creating algebras</h2>
<!--====================================================================-->
<p>By an <b>algebra</b>, we mean a free $\mathbf Z$-module of
finite rank endowed with a biadditive multiplication; we do not
require this multiplication to be associative or Lie. Given a
$\mathbf Z$-basis $x_1,\dotsc,x_d$ of an algebra $L$, define
$\alpha_{ije}\in \mathbf Z$ by</p>
\[ x_i x_j = \sum_{e=1}^d \alpha_{ije} x_e. \]
<p>The numbers $\alpha_{ije}$ are the <b>structure constants</b> of
$L$ with respect to the chosen basis $(x_1,\dotsc,x_d)$. The
principal method for specifying an algebra in Zeta is to provide
structure constants as a nested list</p>
\[ \begin{matrix} [[ (\alpha_{111},\dotsc,\alpha_{11d}), &amp;
\dotsc &amp; (\alpha_{1d1},\dotsc,\alpha_{1dd}) ]\phantom], \\
\vdots &amp; &amp; \vdots \\ \phantom[[
(\alpha_{d11},\dotsc,\alpha_{d1d}), &amp; \dotsc &amp;
(\alpha_{dd1},\dotsc,\alpha_{ddd}) ]] \\ \end{matrix} \]
<p>as the first argument of <code>Zeta.Algebra</code>. (We note
that the table of structure constants of an instance of
<code>Zeta.Algebra</code> is stored in the <code>table</code>
attribute.)</p>
<!--====================================================================-->
<h2 id="top">3.2. Computing topological zeta functions</h2>
<!--====================================================================-->
<p>Given an algebra obtained via <code>Zeta.Algebra</code>, the
function <code>Zeta.topological_zeta_function</code> can be used to
attempt to compute an associated topological zeta function.
Specifically, <code>Zeta.topological_zeta_function(L,
'subalgebras')</code>  will attempt to compute the topological subalgebra zeta
function of $L$ as a rational function in $s$, while
<code>Zeta.topological_zeta_function(L, 'ideals')</code> will do
the same for ideals.
If $L$ is a nilpotent Lie algebra, then
<code>Zeta.topological_zeta_function(L, 'reps')</code>
will attempt to compute the topological representation zeta function
of the unipotent algebraic group over $\mathbf Q$ corresponding to
$L\otimes_{\mathbf Z} \mathbf Q$.</p>
<p>In general, such computations are not guaranteed to succeed. If
the method for computing topological zeta functions from [<a href=
"#topzeta">1</a>,<a href="#topzeta2">2</a>] (for subalgebras and ideals) or
  [<a href="#unipotent">3</a>] (for representations) fails,
<code>Zeta.topological_zeta_function</code> will raise an exception of type <code>Zeta.ReductionError</code>.
Disregarding bugs in Zeta, Sage, or elsewhere,
whenever <code>Zeta.topological_zeta_function</code> does 
finish successfully, its output is supposed to be correct.</p>
<!--====================================================================-->
<h4>Example (subalgebras and ideals)</h4>
<!--====================================================================-->
<p>To illustrate the computation of topological subobject zeta functions,
consider the commutative algebra $L = \mathbf Z[X]/X^3$. As a
$\mathbf Z$-basis of $L$, we choose $(1,x,x^2)$, where $x$ is the
image of $X$ in $L$. The associated nested list of structure
constants is</p>
\[ \begin{matrix} [[(1, 0, 0), &amp; (0, 1, 0), &amp; (0, 0,
1)]\phantom],\\ \phantom[ [(0, 1, 0), &amp; (0, 0, 1), &amp; (0, 0,
0)]\phantom],\\ \phantom[[(0, 0, 1), &amp; (0, 0, 0), &amp; (0, 0,
0)]]. \end{matrix} \]
<p>The following documents a complete Sage session leading to the
computation of the topological subalgebra and ideal zeta functions
of $L$.</p>
<hr>
<pre><code>sage: import Zeta
sage: L = Zeta.Algebra([[(1, 0, 0), (0, 1, 0), (0, 0, 1)], [(0, 1, 0), (0, 0,1), (0, 0, 0)], [(0, 0, 1), (0, 0, 0), (0, 0, 0)]])
sage: Zeta.topological_zeta_function(L, 'subalgebras')
2*(15*s - 8)/((5*s - 4)*(3*s - 2)^2*s)
sage: Zeta.topological_zeta_function(L, 'ideals')
1/((3*s - 2)*(2*s - 1)*s)
</code></pre>
<hr>
<!--====================================================================-->
<h4>Example (representations)</h4>
<!--====================================================================-->
<p>We illustrate the computation of topological representation zeta functions
of unipotent algebraic groups (over $\mathbf Q$) using the familiar example of
the  Heisenberg group $\mathbf H$.
The first step is to construct a $\mathbf Z$-form of its Lie algebra.
We choose the natural $\mathbf Z$-form $L = \mathbf Z x_1
  \oplus \mathbf Z x_2 \oplus \mathbf Z x_3$ with $[x_1,x_2] = x_3$, $[x_2,x_1]
  = -x_3$ and $[x_i,x_j] = 0$ in the remaining cases.
The list of structure constants of $L$ with respect to the basis $(x_1,x_2,x_3)$
  is</p>
\[ \begin{matrix} [[(0, 0, \phantom-0), &amp; (0, 0, 1), &amp; (0, 0, 0)]\phantom],\\ \phantom[ [(0, 0, -1), &amp; (0, 0, 0), &amp; (0, 0,0)]\phantom],\\ \phantom[[(0, 0, \phantom-0), &amp; (0, 0, 0), &amp; (0, 0,
0)]]. \end{matrix} \]
<p>The following documents a complete Sage session leading to the
computation of the topological representation zeta function of $\mathbf H$.
</p>
<hr>
<pre><code>sage: import Zeta
sage: L = Zeta.Algebra([[(0, 0, 0), (0, 0, 1), (0, 0, 0)], [(0, 0,-1), (0, 0, 0), (0, 0, 0)], [(0, 0, 0), (0, 0, 0), (0, 0, 0)]])
sage: Zeta.topological_zeta_function(L, 'reps')
s/(s - 1)
</code></pre>
<hr>
<!--====================================================================-->
<h2 id="pad">3.3. Computing local zeta functions</h2>
<!--====================================================================-->

<!--====================================================================-->
<h3 id="uniform">3.3.1 Uniform zeta functions</h3>
<!--====================================================================-->

<p>Using most of the same arguments as <code>Zeta.topological_zeta_function</code>
  from <a href="#top">&sect;3.2</a>, the
  function <code>Zeta.local_zeta_function</code> can be used to attempt to
  compute <em>generic</em> local subalgebra, ideal, or representation zeta
  functions&mdash;that is to say, computed zeta functions will be valid for all but finitely
  many primes $p$ and arbitrary finite extensions of $\mathbf Q_p$ as in
  [<a href="#topzeta">1</a>,&sect;5.2] and
  [<a href="#unipotent">3</a>,&sect;2.2].
  If the method from [<a href="#padzeta">4</a>] is unable to compute a
  specific zeta function, an exception of type <code>Zeta.ReductionError</code> will be raised.
</p>

<p>By default, <code>Zeta.local_zeta_function</code> will attempt to construct a
single rational function, $W(q,t)$ say, in $(q,t)$ such that for almost all
primes $p$ and all $q = p^f$ ($f \ge 1$), the local zeta function in question 
obtained after base extension from $\mathbf Q_p$ to a degree $f$ extension is
given by $W(q,q^{-s})$.
Crucially, such a rational function $W(q,t)$ need not exist and even if it does, Zeta may be unable
to compute it.
</p>

<h4>Example (uniform local zeta functions)</h4>
<p>Let $L$ be the Heisenberg Lie algebra as above. 
  The following computes the associated generic local subalgebra, ideal, and 
  representation zeta functions.</p>
<hr>
<pre><code>sage: Zeta.local_zeta_function(L, 'subalgebras')
-(q^2*t^2 + q*t + 1)/((q^3*t^2 - 1)*(q*t + 1)*(q*t - 1)*(t - 1))
sage: Zeta.local_zeta_function(L, 'ideals')
-1/((q^2*t^3 - 1)*(q*t - 1)*(t - 1))
sage: Zeta.local_zeta_function(L, 'reps')
(t - 1)/(q*t - 1)</code></pre>
<hr>
<p>That is, for almost all primes $p$ and all finite extensions $K/\mathbf Q_p$,
the subalgebra and ideal zeta functions of $L \otimes \mathfrak O_K$ are exactly
the first two rational functions in $q$ and $t = q^{-s}$; here, 
$\mathfrak O_K$ denotes the valuation ring of $K$ and $q$ the residue field
  size.
These results are due to
<a href="http://dx.doi.org/10.1007/BF01393692">Grunewald, Segal,
    and Smith</a> and in fact valid for arbitrary $p$; the restriction to $K =
    \mathbf Q_p$ in their work is not essential.
Similarly, the above computation using Zeta shows that if $H \leqslant \mathrm{GL}_3$
is the Heisenberg group scheme, then 
for almost all primes $p$ and all finite extensions $K/\mathbf Q_p$,
the representation zeta function of $H(\mathfrak O_K)$ is
$(q^{-s}-1)/(q^{1-s}-1)$, as proved (for all $p$) by
<a href="http://dx.doi.org/10.1353/ajm.2014.0010">Stasinski and Voll</a>.
</p>

<h3 id="symbolic">3.3.2 Non-uniform zeta functions: the symbolic mode</h3>
<p>
Assuming the method from [<a href="#padzeta">4</a>] applies,
Zeta supports limited computations of non-uniform generic local zeta
functions&mdash;that is, instances where no rational function $W(q,t)$ as above exists.
For that purpose, <code>symbolic=True</code> needs to be
passed to <code>Zeta.local_zeta_function</code>.
If successful, the output will then be given by a rational function in $q$, $t$,
and finitely many variables of the form <code>sc_i</code>, each corresponding to the
number of rational points over the residue field of $K$ of (the reduction modulo
$p$ of) the subvariety <code>Zeta.common.symbolic_count_varieties[i]</code> of
some algebraic torus.
</p>

<h4>Example (non-uniform local zeta functions)</h4>
<p> Let $L$ be the Lie algebra with $\mathbf Z$-basis $(x_1,\dotsc,x_6)$ and
non-trivial commutators $[x_1,x_2] = x_3$, $[x_1,x_3] = x_5$, $[x_1,x_4] =
  3x_6$, $[x_2,x_3] = x_6$, and $[x_2,x_4] = x_5$; this algebra is called $L_{6,24}(3)$ in 
  <a href="http://dx.doi.org/10.1016/j.jalgebra.2006.08.006">de&nbsp;Graaf's classification</a>.
  We may  compute the generic local representation zeta functions associated
  with $L$ as follows. 
</p>

<hr>
<pre><code>sage: Zeta.local_zeta_function(L, 'reps', symbolic=True)
-(q*sc_0*t - q*t^2 - sc_0*t + 1)*(t - 1)/((q^3*t^2 - 1)*(q*t - 1))
sage: Zeta.common.symbolic_count_varieties[0]
Subvariety of 1-dimensional torus defined by [x^2 - 3]</code></pre>
<hr>

<p>
We thus see how the generic local representation zeta functions associated with
$L$ depend on whether $3$ is a square in the residue field of $K$.
Calling <code>Zeta.local_zeta_function(L, 'reps')</code> without
<code>symbolic=True</code> will result in an error.
As computations with <code>symbolic=True</code> are generally substantially more
computationally demanding, they should only be attempted as a last resort.</p> 

<!--====================================================================-->
<h2 id="igusa">3.4. Computing Igusa-type zeta functions</h2>
<!--====================================================================-->

<p>Zeta also provides rudimentary support for the computation of local and topological zeta functions
associated with polynomials and polynomial mappings under the non-degeneracy
assumptions from [<a href="#topzeta">1</a>].
Given $f_1,\dotsc,f_r \in \mathbf Q[X_1,\dotsc,X_n]$, Zeta can be used to
  attempt to compute
the generic local zeta functions (in the sense discussed above) defined by
\[
\int_{\mathfrak O_K^n} \lVert f_1(x),\dotsc, f_r(x) \rVert^s_K \mathrm
  d\mu_K(x)
\]
or the associated topological zeta function;
here, $\mu_K$ denotes the Haar measure and $\lVert \cdotp \rVert_K$
the maximum norm, both normalised as usual.</p>
<p>
For a single polynomial, the method used by Zeta is very closely related to
  combinatorial formulae of <a href="http://dx.doi.org/10.2307/2152708">Denef and Loeser</a> and 
<a href="http://dx.doi.org/10.1006/jnth.2000.2606">Denef and Hoornaert</a>.
In order to attempt to compute topological or generic local zeta functions
associated with a polynomial (or a polynomial mapping), pass a
multivariate polynomial (or a list of these)
to <code>Zeta.topological_zeta_function</code>
or <code>Zeta.local_zeta_function</code>, respectively
while providing <code>'poly'</code> as the second argument.
</p>

<h4>Example (Igusa-type zeta functions)</h4>
The following computes the local and topological zeta functions associated with
$f$ and $(f,g)$, where $f = X^3 - XYZ$ and $g = X^2 - Y^2$.
<hr>
<pre><code>sage: R.&lt;x,y,z&gt; = QQ[]
sage: f = x^3 -x*y*z
sage: g = x^2 - y^2
sage: Zeta.local_zeta_function(f, 'poly')
(q^4 + q^2*t^2 - q^3 - 2*q^2*t - q*t^2 + q^2 + t^2)*(q - 1)/((q^2 + q*t + t^2)*(q - t)^3)
sage: Zeta.topological_zeta_function(f, 'poly')
1/3*(s^2 + 2*s + 3)/(s + 1)^3
sage: Zeta.local_zeta_function([f,g], 'poly')
(q^2 + 2*q + t)*(q - 1)^2/((q^2 - t)*(q + t)*(q - t))
sage: Zeta.topological_zeta_function([f,g], 'poly')
2/((s + 2)*(s + 1))</code></pre>
<hr>

<p>Non-uniform examples can be handled as in <a href="#symbolic">&sect;3.3.2</a>.
</p>

<!--====================================================================-->
<h2 id="modules">3.5. Modules and algebras with operators</h2>
<!--====================================================================-->
<p>In [<a href="#topzeta">1</a>,<a href="#topzeta2">2</a>],
(topological) ideal zeta functions were treated as special cases of
submodule zeta functions. In Zeta, we regard modules as special
cases of algebras with operators. Namely, each algebra $L$ in Zeta
is endowed with a possibly empty set $\Omega$ of operators,
i.e.&nbsp;$\Omega$ consists of additive endomorphisms of $L$. The
topological and local subalgebra and ideal zeta functions of $L$ are always
understood to be those arising from the enumeration of
$\Omega$-invariant subalgebras or ideals, respectively. Thus, if
the multiplication of $L$ is trivial, then the $\Omega$-invariant
subalgebras (and ideals) of $L$ are precisely the submodules of $L$
under the action of the enveloping associative unital ring of $\Omega$
within $\mathrm{End}(L)$.</p>
<p>In practice, $\Omega$ is given by a finite list of matrices (or
nested lists of integers representing those matrices) corresponding
to the defining basis of $L$. This list is then supplied to
<code>Zeta.Algebra</code> using the keyword parameter
<code>operators</code>. For algebras with zero multiplication,
instead of entering structure constants, you can provide a keyword
argument <code>rank</code> to <code>Zeta.Algebra</code> which
initialises all structure constants to zero.</p>
<!--====================================================================-->
<h4>Example</h4>
<!--====================================================================-->
<p>We illustrate the computation of the topological submodule zeta
function arising from the enumeration of sublattices within
$\mathbf Z^3$ invariant under the matrix \[ \begin{bmatrix} 1 &amp;
1 &amp; -1 \\ 0 &amp; 1 &amp; 1 \\ 0 &amp; 0 &amp; 1 \end{bmatrix}
\]</p>
<hr>
<pre>
<code>sage: M = Zeta.Algebra(rank=3, operators=[ [[1,1,-1],[0,1,1],[0,0,1]] ])
sage: Zeta.topological_zeta_function(M)
1/((3*s - 2)*(2*s - 1)*s)
</code></pre>
<hr>
<p>In the database included with Zeta, for examples of algebras
with trivial multiplication but non-empty lists of operators, we
did not include ideal zeta functions; they coincide with the corresponding
subalgebra and submodule zeta functions.</p>


<!--====================================================================-->
<h2 id="average">3.6. Average sizes of kernels</h2>
<!--====================================================================-->

<p>
  Subject to the same restrictions as above, Zeta supports the
  computation of the (local) &ldquo;ask zeta functions&rdquo; defined and studied in [<a href="#ask">5</a>,<a href="#ask">6</a>].
</p>

<p>
Let $\mathfrak{O}$ be a compact discrete valuation ring
with maximal ideal $\mathfrak{P}$.
Let $M \subset \mathrm{M}_{d\times e}(\mathfrak{O})$ be a submodule.
Let $M_n \subset \mathrm{M}_{d\times e}(\mathfrak{O}/\mathfrak{P}^n)$
denote the image of $M$ under the natural map
$\mathrm{M}_{d\times e}(\mathfrak{O}) \to \mathrm{M}_{d\times e}(\mathfrak{O}/\mathfrak{P}^n)$.
The <b>ask zeta function</b>  of $M$ is
\[
\mathsf{Z}_M(t) = \sum_{n=0}^\infty
\mathrm{ask}(M_n) t^n,
\]
where $\mathrm{ask}(M_n)$ denotes the average size of the kernels of the
elements of $M_n$ acting by right-multiplication on $(\mathfrak{O}/\mathfrak{P}^n)^d$.
</p>

<p>
  Zeta can be used to attempt to compute generic local ask zeta
  functions in the following global setting.
  Let $M \subset \mathrm{M}_{d\times e}(\mathbf{Z})$ be a submodule of
  rank $\ell$. Let $A$ be an integral $d \times e$ matrix of linear
  forms in $\ell$ variables such that $M$ is precisely the module of
  specialisations of $A$. Then <code>Zeta.local_zeta_function(A,
  'ask')</code> attempts to compute $\mathsf{Z}_{M \otimes
  \mathfrak{O}_K}(t)$
  for almost all primes $p$ and all finite extensions $K/\mathbf{Q}_p$
  in the same sense as in <a href="pad">&sect;3.3</a>.
  The optional keyword parameter <code>mode</code> determines whether
  Zeta attempts to compute ask zeta functions
  using the functions $\mathrm{K}_M$ (<code>mode='K'</code>)
  or $\mathrm{O}_M$ (<code>mode='O'</code>) from [<a href="ask">5</a>, &sect;4],
  respectively; the default is <code>mode='O'</code>.
  To perform a computation using the &ldquo;bullet dual&rdquo; operation from
  [<a href="ask2">6</a>, &sect;4], use <code>mode='BK'</code>.
  </p>

<!--====================================================================-->
<h4>Example</h4>
<!--====================================================================-->
<p>We compute the generic local ask zeta functions associated
  with $\mathrm{M}_{2\times 3}(\mathbf{Z})$.
</p>
<hr>
<pre>
<code>sage: R.&lt;a,b,c,d,e,f&gt; = QQ[]
sage: A = matrix([[a,b,c],[d,e,f]])
sage: Zeta.local_zeta_function(A, 'ask')
-(q^3 - t)/((q - t)*q^2*(t - 1))
</code></pre>
<hr>

<!--====================================================================-->
<h2 id="conjugacy">3.7. Conjugacy class zeta functions</h2>
<!--====================================================================-->

<p>
Let $L$ be a nilpotent Lie algebra constructed as
in <a href="#algebras">&sect;3.1</a>.
Then <code>Zeta.local_zeta_function(L, 'cc')</code> attempts to
compute the generic local conjugacy class zeta functions associated
with the unipotent algebraic group corresponding to $L \otimes
\mathbf{Q}$; see [<a href="#ask">5</a>, &sect;7.5].
The optional keyword parameter <code>mode</code> has the same
interpretation as in <a href="#average">&sect;3.6</a>.</p>

<!--====================================================================-->
<h4>Example</h4>
<!--====================================================================-->
<p>We compute the generic local conjugacy class zeta functions of
  the Heisenberg group.
</p>
<hr>
<pre>
<code>sage: L = Zeta.Algebra([[(0, 0, 0), (0, 0, 1), (0, 0, 0)], [(0, 0,-1), (0, 0, 0), (0, 0, 0)], [(0, 0, 0), (0, 0, 0), (0, 0, 0)]])
sage: Zeta.local_zeta_function(L, 'cc')
-(t - 1)/((q^2*t - 1)*(q*t - 1))
</code></pre>
<hr>

<!--====================================================================-->
<h2 id="graphs">3.8. Graph and hypergraphs</h2>
<!--====================================================================-->

<p>Zeta supports the computation of the rational functions $W_H(q,t)$
  and $W^\pm_G(q,t)$ introduced and studied in [<a href="#cico">7</a>].
  These functions are the uniform ask zeta functions associated with
  modules of suitable types of matrices with support constraints defined by a
  hypergraph $H$ or graph $G$, respectively.
  By [<a href="#cico">7</a>, Cor. B], the functions $W^-_G(q,t)$ 
  enumerate conjugacy classes of suitable groups derived from $G$.
  The same is true of the functions $W_H(q,t)$ whenever $H$ is a modelling
  hypergraph of a cograph; see [<a href="#cico">7</a>, Thm D].
</p>

<!--====================================================================-->
<h3>Hypergraphs</h3>
<!--====================================================================-->
<p>
  Hypergraphs can be specified using incidence matrices.
  An $n\times m$ $(0,1)$-matrix $A = [a_{ij}]$ defines a hypergraph
  $H$ on the vertex set $\{0,\dotsc,n-1\}$ with hyperedges
  $e_0,\dotsc,e_{m-1}$, where the support of $e_j$ is the set of those $i =
  0,\dotsc,n-1$ with $a_{i+1,j+1} = 1$.
  The rational function $W_H(q,t)$ can be computed
  using <code>Zeta.local_zeta_function(A, 'inc')</code>.
</p>

<!--====================================================================-->
<h4>Example</h4>
<!--====================================================================-->
<p>
  The following computation determines the ask zeta function of the module of
  upper triangular $3\times 3$ matrices, in accordance with
  both [<a href="#ask">5</a>, Prop. 5.15] and
  [<a href="#cico">7</a>, Prop. 5.9].
</p>
<hr>
<pre>
<code>sage: A = matrix([[1,1,1], [0,1,1], [0,0,1]])
sage: Zeta.local_zeta_function(A, 'inc')
(q - t)^3/(q^3*(t - 1)^4)</code>
</pre>
<hr>

<p>
  Alternatively, hypergraphs can be specified in terms of their hyperedge
  multiplicities.
  Let <code>D</code> be a Python dictionary whose keys are tuples
  $a = (a_1,\dotsc,a_\ell)$ of integers with $0 \le a_j < n$ and
  $a_1 < a_2 < \dotsb < a_\ell$ and whose values are non-negative
  integers.
  Then <code>D</code> defines a hypergraph $H$ with vertex set $\{0,\dotsc,n-1\}$
  such that each value <code>k = D[a]</code> for a tuple as above
  corresponds to $k$ hyperedges of $H$, each with support
  $\{a_1,\dotsc,a_\ell\}$.
  The rational function $W_H(q,t)$ can be computed
  using <code>Zeta.local_zeta_function(n, 'inc', mu=D)</code>.
</p>

<!--====================================================================-->
<h4>Example</h4>
<!--====================================================================-->
<p>
  The following computation determines the ask zeta function of the module of all
  $4 \times 6$ matrices of the form
  $$
  \begin{bmatrix}
  * &amp; * &amp; * &amp; * &amp; * &amp; *\\
  * &amp; * &amp; * &amp; * &amp; * &amp; *\\
  0 &amp; 0 &amp; * &amp; * &amp; * &amp; *\\
  0 &amp; 0 &amp; 0 &amp; * &amp; * &amp; * 
  \end{bmatrix}.
  $$
</p>
<hr>
<pre>
<code>sage: D = { (0,1): 2, (0,1,2): 1, (0,1,2,3): 3 }
sage: Zeta.local_zeta_function(4, 'inc', mu=D)
-(q^4 - t)*(q^3 - t)^2/((q^2 - t)^3*q^4*(t - 1))</code></pre>
<hr>
<p>This formula can also be obtained using [<a href="#ask">7</a>, Prop. 5.9].</p>

<!--====================================================================-->
<h3>Graphs (negative adjacency representations)</h3>
<!--====================================================================-->

<p>
  Given a
  <a href="http://doc.sagemath.org/html/en/reference/graphs/index.html">graph</a>
  $G$, the rational function $W_G^-(q,t)$ from [<a href="#cico">7</a>] can be
  computed using <code>Zeta.local_zeta_function(G, 'adj')</code>.
</p>

<!--====================================================================-->
<h4>Example</h4>
<!--====================================================================-->
<p>The following determines the rational function $W^-_G(q,t)$, where $G$ is
  the <a href="https://en.wikipedia.org/wiki/Butterfly_graph">butterfly
  graph</a>.
</p>
<hr>
<pre><code>sage: G = Graph(5)
sage: G.add_edges([ (0,1), (0,4), (1,4), (2,3), (2,4), (3,4) ])
sage: Zeta.local_zeta_function(G, 'adj')
-(q^3*t + q^3 - 2*q^2*t - 2*q*t + t^2 + t)/((q*t - 1)^2*q^3*(t - 1))
</code></pre>
<hr>
<p>By the Cograph Modelling Theorem [<a href="#cico">7</a>, Thm D], the
  preceding rational function coincides with $W_H(q,t)$, where $H$ is a hypergraph
  with incidence matrix
  $$\begin{bmatrix}
  1 &amp; 1 &amp; 1 &amp; 1 \\
  1 &amp; 1 &amp; 0 &amp; 0 \\
  1 &amp; 1 &amp; 0 &amp; 0 \\
  1 &amp; 0 &amp; 1 &amp; 0 \\
  1 &amp; 0 &amp; 1 &amp; 0\end{bmatrix}.$$
  We can confirm this as follows.
</p>
<hr>
<pre><code>sage: A = matrix([[1,1,1,1], [1,1,0,0], [1,1,0,0], [1,0,1,0], [1,0,1,0]])
sage: Zeta.local_zeta_function(A, 'inc')
-(q^3*t + q^3 - 2*q^2*t - 2*q*t + t^2 + t)/((q*t - 1)^2*q^3*(t - 1))
</code></pre><hr>

<!--====================================================================-->
<h3>Graphs (positive adjacency representations)</h3>
<!--====================================================================-->
<p>
  In order to compute the rational function $W_G^+(q,t)$ for a graph $G$,
  simply provide the keyword argument <code>signs=1</code> when calling
  <code>Zeta.local_zeta_function</code>.
</p>

<!--====================================================================-->
<h4>Example</h4>
<!--====================================================================-->
<p>Let $G$ be the butterfly graph from above.</p>
<hr>
<pre><code>sage: Zeta.local_zeta_function(G, 'adj', signs=1)
(q^6*t^6 + q^5*t^7 - q^6*t^5 - 3*q^5*t^6 - 6*q^4*t^7 + q^7*t^3 - 5*q^6*t^4 + 3*q^5*t^5 + 3*q^4*t^6 + 14*q^3*t^7 - 3*q^7*t^2 + 7*q^6*t^3 + 5*q^5*t^4 + 17*q^4*t^5 - 12*q^3*t^6 - 14*q^2*t^7 - q^7*t + 24*q^6*t^2 - 58*q^5*t^3 + 45*q^4*t^4 - 83*q^3*t^5 + 46*q^2*t^6 - 2*q*t^7 + t^8 - q^7 + 2*q^6*t - 46*q^5*t^2 + 83*q^4*t^3 - 45*q^3*t^4 + 58*q^2*t^5 - 24*q*t^6 + t^7 + 14*q^5*t + 12*q^4*t^2 - 17*q^3*t^3 - 5*q^2*t^4 - 7*q*t^5 + 3*t^6 - 14*q^4*t - 3*q^3*t^2 - 3*q^2*t^3 + 5*q*t^4 - t^5 + 6*q^3*t + 3*q^2*t^2 + q*t^3 - q^2*t - q*t^2)/((q*t - 1)*(q - t)^3*q^4*(t + 1)*(t - 1)^4)
</code></pre>
<hr>

<!--====================================================================-->
<h2 id="cntpts">3.9. Counting rational points</h2>
<!--====================================================================-->

<p>The methods for determining generic local zeta functions described
  in <a href="#pad">Section 3.3</a> rely on functionality for symbolically
  enumerating rational points of affine schemes.
  As it might be of independent interest, this functionality can also be
  invoked directly as follows.</p>

<p>Let $f_1,\dotsc,f_r\in \mathbf Z[X_1,\dotsc,X_n]$ and let $Y$ be the
  subscheme of $\mathbf A^n_{\mathbf Z}$ defined by $f_1 = \dotsb = f_r = 0$.
  (The polynomials $f_1,\dotsc,f_r$ can actually have coefficients in $\mathbf Q$
  in which case $Y$ is to be replaced by the corresponding subscheme of affine $n$-space over
  $\mathbf Z[1/N]$ for a suitable integer $N \geqslant 1$.)</p>

<p>A call <code>Zeta.count_points([</code>$f_1,\dotsc,f_r$<code>])</code>
  constructs a symbolic expression, <code>E</code> say, involving (in general) symbols <code>q</code>
  and <code>sc_i</code> (see <a href="#symbolic">Section 3.3.2</a>).
  For almost all primes $p$ and all powers $q$ of $p$, the number $\# Y(\mathbf F_q)$ is
  then obtained from <code>E</code> by replacing <code>q</code> by $q$ and
  each <code>sc_i</code> by the number of $\mathbf F_q$-rational points of
  <code>Zeta.common.symbolic_count_varieties[i]</code>, a subscheme of a torus.
  We note that <code>Zeta.count_points</code> does not keep track of
  the finitely many exceptional primes that need to be excluded.</p>

<p>
  The function <code>Zeta.count_points</code> attempts to detect when
  $\#Y(\mathbf F_q)$ is polynomial in $q$ (excluding small
  characteristics). Of course, these attempts are not guaranteed to succeed.
</p>

<!--====================================================================-->
<h4>Example</h4>
<!--====================================================================-->
<hr>
<pre><code>sage: R = PolynomialRing(QQ,'x', 8)
sage: R.inject_variables(verbose=False)
sage: F = [x2*x3^2 - x1*x3*x4 + 1/4*x0*x4^2, x0*x5*x6 + 2*x1*x3*x7 - x0*x4*x7]
sage: Zeta.count_points(F)
(q^3 + 2*q^2 - 3*q + 1)*(2*q - 1)*q^2
</code></pre>
<hr>

<!--====================================================================-->
<h1 id="db">4. The built-in database of examples</h1>
<!--====================================================================-->
<!--====================================================================-->
<h2 id="access">4.1 Accessing the database</h2>
<!--====================================================================-->
<p>Zeta includes a &ldquo;database&rdquo; of algebras. When
topological or local zeta functions associated with an algebra in the database
have been successfully computed using Zeta, these are stored as well.</p>
<p>Each algebra stored in Zeta can be referred to using its unique
identification number or one of finitely many names; identification numbers may
change between versions of Zeta. Access to
these algebras is provided using the function
<code>Zeta.lookup</code>.</p>
<p>If <code>Zeta.lookup</code> is called with precisely one
argument <code>entry</code>, then <code>entry</code> should be
either an identification number or a name of an algebra, $L$ say,
in the database. In this case, <code>Zeta.lookup</code> will return
$L$. Optional further arguments to <code>Zeta.lookup</code> can be
used to access other information about $L$:</p>
<ul>
<li>If the second argument is <code>'subalgebras'</code>,
<code>'ideals'</code>, or <code>'reps'</code> and the third argument
is <code>'local'</code> or <code>'topological'</code>,
then <code>Zeta.lookup</code> will return
the local or topological subalgebra, ideal, or representation zeta function of
$L$, respectively, if it is known, and <code>None</code> otherwise.</li>
<li>If the second argument is <code>'id'</code>, then
<code>Zeta.lookup</code> returns the identification number of
$L$.</li>
<li>If the second argument is <code>'names'</code>, then
<code>Zeta.lookup</code> returns a list of the stored names of
$L$.</li>
</ul>
<p>When called without arguments, <code>Zeta.lookup</code> returns
a list of pairs <code>(i,names)</code>, where <code>i</code> ranges
over the identification numbers of all algebras in the database and
<code>names</code> is a possibly empty list of names associated
with the <code>i</code>th algebra.</p>
<!--====================================================================-->
<h4>Example</h4>
<!--====================================================================-->
<p>The algebra $L = \mathbf Z[X]/X^3$ from <a href=
"#tut">Section&nbsp;3.1</a> is known to Zeta under the name
<code>'ZZ[X]/X^3'</code>; it can be retrieved via <code>L = Zeta.lookup('ZZ[X]/X^3')</code>.
We may recover the pre-computed topological zeta functions of $L$ as follows:</p>
<hr>
<pre>
<code>sage: Zeta.lookup('ZZ[X]/X^3', 'subalgebras', 'topological')
2*(15*s - 8)/((5*s - 4)*(3*s - 2)^2*s)
sage: Zeta.lookup('ZZ[X]/X^3', 'ideals', 'topological')
1/((3*s - 2)*(2*s - 1)*s)
</code></pre>
<hr>
<!--====================================================================-->
<h2 id="names">4.2 Algebras and their names</h2>
<!--====================================================================-->
<p>Apart from self-explanatory names such as
<code>'sl(2,ZZ)'</code> and <code>'gl(2,ZZ)'</code>, Zeta also
includes algebras $L_{d,i}$, $L_{d,i}(\varepsilon)$, $L^i$,
$L^i_a$, $M^i$, and $M^i_a$ taken from de&nbsp;Graaf's tables of
<a href=
"http://dx.doi.org/10.1016/j.jalgebra.2006.08.006">nilpotent</a>
and <a href=
"http://projecteuclid.org/euclid.em/1120145567">soluble</a> Lie
algebras; their corresponding names in Zeta are of the form
<code>'L(d,i)'</code>, <code>'L(d,i;eps)'</code>, <code>'L^i'</code>,
<code>'L^i(a)'</code>, <code>'M^i'</code>, and <code>'M^i(a)'</code>.
For the infinite families among these algebras, we only included
selected specialisations of the parameters.
Recall [<a href="#topzeta">1</a>,&nbsp;Prop.&nbsp;5.19(ii)] that the
topological subalgebra and ideal zeta functions of an algebra $L$
(over $\mathbf Z$) only depend on the $\mathbf C$-isomorphism type
of $L\otimes_{\mathbf Z}\mathbf C$;
a similar statement holds for topological representation zeta functions 
by [<a href="#unipotent">3</a>,&nbsp;Prop.&nbsp;4.3].</p>
<p>
Similar to Woodward's tables, we use the notation <code>'g(...)'</code> to refer
to $\mathbf Z$-forms of algebras
from <a href="http://dx.doi.org/10.2307/2154390">Seeley</a>'s list of
7-dimensional nilpotent Lie algebras over $\mathbf C$; for
example <code>'g(147A)'</code> is a $\mathbf Z$-form of the algebra $1,4,7_A$
in Seeley's list.
</p>
<p>
The algebras <code>'N_i^(8,d)'</code> are taken
from the lists of 
<a href="http://dx.doi.org/10.1080/00927872.2010.483342">Ren and Zhu</a>,
and <a href="http://dx.doi.org/10.1007/s10587-013-0057-6">Yan and Deng</a>.
</p>
<p>The algebras called <code>'C(d,i)'</code> and <code>'C(d,i;eps)'</code> in
Zeta are &ldquo;commutative versions&rdquo; of the nilpotent Lie
rings <code>'L(d,i)'</code> and <code>'L(d,i;eps)'</code> respectively:
they were obtained by inverting the signs of all entries underneath
the diagonal in the matrices of structure constants.</p>
<p>An algebra called <code>'name[eps]'</code> in Zeta is obtained by
  tensoring <code>'name'</code> with the dual numbers as
  in [<a href="#unipotent">3</a>, &sect;6].
</p>
<!--====================================================================-->
<h2 id="listing">4.3 Listing algebras, topological zeta functions, and their
properties</h2>
<!--====================================================================-->
<p>The function <code>Zeta.examples.printall</code> generates a
text-based list of</p>
<ul>
<li>algebras known to Zeta,</li>
<li>structural information about each algebra,</li>
<li>known associated topological zeta functions,</li>
<li>numerical invariants of these zeta functions (degree, complex
roots, ...)</li>
</ul>
<p>and writes these to an optional file-like object (which defaults
to <code>stdout</code>). The output of this function is also
available for <a href=
"https://torossmann.github.io//Zeta/topzetas.txt">download</a>.</p>
<p>By the <b>essential value</b> of a rational function $Z\in
\mathbf Q(s)$ at a point $w\in \mathbf C$, we mean the value of
$Z/(s-w)^m$ at $s = w$, where $m$ is the order of $Z$ at $w$;
similarly, for $w = \infty$. The output of
<code>Zeta.examples.printall</code> (and hence the content of the
file linked to above) contains the essential values of topological
zeta functions at $0$ and $\infty$; these are related to
Conjectures&nbsp;IV&ndash;V from [<a href=
"#topzeta">1</a>,<a href="#topzeta2">2</a>].</p>

<!--====================================================================-->
<h1 id="advanced">5. Advanced usage</h1>
<!--====================================================================-->
<!--====================================================================-->
<h2 id="creation">5.1 More on the creation of algebras</h2>
<!--====================================================================-->
<p>As an integral version of terminology used by <a href=
"http://dx.doi.org/10.1515/CRELLE.2009.065">Evseev</a>, we say that
a $\mathbf Z$-basis $(x_1,\dotsc,x_d)$ of an algebra $L$ is
<b>simple</b> if each product $x_ix_j$ is of the form
$\varepsilon_{ij} x_{a_{ij}}$ for $\varepsilon_{ij} \in
\{-1,0,1\}$. In this case, the structure constants of $L$ with
respect to $(x_1,\dotsc,x_d)$ are determined by the matrix $A =
[\varepsilon_{ij} a_{ij}]_{i,j=1,\dotsc,d}$. Zeta supports the
creation of algebras from such a matrix $A$ by passing
<code>simple_basis=True</code> and <code>matrix=</code>$A$ as
arguments to <code>Zeta.Algebra</code>.</p>
<p>For example, the Heisenberg Lie ring with $\mathbf Z$-basis
$(x_1,x_2,x_3)$ and non-trivial products $[x_1,x_2] = x_3$ and
$[x_2,x_1] = -x_3$ from above can be defined in Zeta via
<code>Zeta.Algebra(simple_basis=True, matrix=[[0,3,0], [-3,0,0],
[0,0,0] ])</code> .</p>
<!--====================================================================-->
<h2 id="blocks">5.2 Additive gradings: blocks</h2>
<!--====================================================================-->

<p>Zeta supports the computation of graded subalgebra and ideal zeta functions
as in [<a href="#padzeta">4</a>].
These zeta functions enumerate homogeneous subobjects with respect to a given
additive decomposition of the underlying module.
Such decompositions are specified using the keyword 
argument <code>blocks</code> of <code>Zeta.Algebra</code>.
To that end, <code>blocks</code>
should be assigned a list $(\beta_1,\dotsc,\beta_r)$ 
of positive integers summing up to the rank of the algebra $L$ in question.
If $(x_1,\dotsc,x_d)$ is the  defining basis of $L$, then the associated
additive decomposition is $L = L_1 \oplus   \dotsb \oplus L_r$ for
$L_j = \bigoplus_{i=\sigma_{j-1}+1}^{\sigma_j} \mathbf Z x_i$
and $\sigma_i = \sum_{e=1}^i \beta_e$.
</p>

<h4>Example (graded zeta functions)</h4>
Let $L$ be the Heisenberg Lie algebra with $\mathbf Z$-basis $(x_1,x_2,x_3)$ and
$[x_1,x_2] = x_3$ as above.
Then $L = L_1 \oplus L_2$ with $L_1 = \mathbf Z x_1 \oplus \mathbf Z x_2$ and
$L_2 = \mathbf Z x_3$ is the associated graded Lie algebra and the following
computes the generic graded local zeta functions arising from the enumeration of its
homogeneous subalgebras.

<hr>
<pre><code>sage: L = Zeta.Algebra([[(0, 0, 0), (0, 0, 1), (0, 0, 0)], [(0, 0,-1), (0, 0, 0), (0, 0, 0)], [(0, 0, 0), (0, 0, 0), (0, 0, 0)]], blocks=[2,1])
sage: Zeta.local_zeta_function(L, 'subalgebras')
-(q*t^3 - 1)/((q*t^2 - 1)*(q*t - 1)*(t + 1)*(t - 1)^2)</code></pre>
<hr>

<!--====================================================================-->
<h2 id="bases">5.3 Changing bases</h2>
<!--====================================================================-->
<p>
(The following only applies to the computation of subalgebra
and ideal zeta functions and not to representation or Igusa-type zeta functions.)
Computations using Zeta are usually very sensitive to the choice
of the basis used to define the structure constants of the algebra
under consideration. If a particular zeta function cannot be
directly computed using Zeta, it might be useful to consider
different bases. Given an algebra <code>L</code> of rank $d$ and an
invertible $d\times d$ matrix <code>A</code> over $\mathbf Z$, the
algebra obtained from $L$ by taking the rows of <code>A</code> as a
basis (relative to the original one) can be constructed via
<code>L.change_basis(A)</code>. In the presence of a non-trivial
grading, the latter is required to be respected by <code>A</code>.</p>
<p>Unless <code>Zeta.local_zeta_function</code>
or <code>Zeta.topological_zeta_function</code> is called with the keyword
argument <code>optimise_basis=False</code>, Zeta will attempt to find a
basis of the algebra, $L$ say, in question such that the associated toric datum
(see [<a href="#topzeta2">2</a>]) is &ldquo;small&rdquo;.
Currently, Zeta simply loops over permutations of the defining basis of $L$.</p>
<!--====================================================================-->
<h2 id="verbose">5.4 Verbosity</h2>
<!--====================================================================-->
<p>If <code>Zeta.local_zeta_function</code>
  or <code>Zeta.topological_zeta_function</code> is called with the keyword
  argument <code>verbose=True</code>, then detailed 
information on the various stages of computations will be
displayed. Apart from illustrating the key steps explained in
[<a href="#topzeta">1</a>,<a href="#topzeta2">2</a>,<a href="#unipotent">3</a>,<a href="#padzeta">4</a>],
  this
can often be helpful when it comes to estimating the feasibility of
the intended computation.</p>
<!--====================================================================-->
<h2 id="cost">5.5 Computational resources</h2>
<!--====================================================================-->
<p>An upper bound on the number of CPUs used by
<code>Zeta.local_zeta_function</code> and
<code>Zeta.topological_zeta_function</code> can be enforced by
providing a numerical value for the keyword parameter
<code>ncpus</code>.</p>
<p>During computations of zeta functions, Zeta uses
various temporary files. Be warned that for some computations
carried out by the author, the combined size of these files
exceeded 50G.</p>
<p>Zeta can be equally demanding when it comes to system memory, in
  particular when computing local zeta functions.
If computations run out of memory, you can try reducing the number
of CPUs used as indicated above or try setting the keyword
parameter <code>profile</code> to <code>Zeta.Profile.SAVE_MEMORY</code>. Setting
<code>profile=Zeta.Profile.SPEED</code> will result in slightly
better performance at the cost of increased memory use.</p>
<!--====================================================================-->
<h2 id="reduction">5.6 Reduction strategies</h2>
<!--====================================================================-->
<p>(The following only applies to the computation of subalgebra
and ideal zeta functions.)
The reduction step explained in [<a href="#topzeta2">2</a>]
depends on a strategy for choosing &ldquo;reduction
candidates&rdquo;. 
A particular strategy can be chosen using the keyword
parameter <code>strategy</code> of <code>Zeta.local_zeta_function</code> or
<code>Zeta.topological_zeta_function</code>. In particular, setting
<code>strategy=Zeta.Strategy.NONE</code> disables reduction
completely while <code>strategy=Zeta.Strategy.NORMAL</code> yields the strategy used
in the paper. Passing <code>strategy=Zeta.Strategy.PREEMPTIVE</code> will
result in a more aggressive reduction strategy which tries to anticipate and
remove causes of singularity in advance. While often slower than
the <code>Zeta.Strategy.NORMAL</code>, this strategy is needed to reproduce some of the
computations recorded in the database (<a href="#db">Section&nbsp;4</a>).</p>
<!--====================================================================-->
<h1 id="references">6. References</h1>
<!--====================================================================-->
<p><a name="topzeta" id="topzeta">[1]</a> T. Rossmann.
<a href="http://dx.doi.org/10.1112/plms/pdv012"><i>Computing topological zeta functions of groups, algebras, and
modules, I</i></a>. Proc. Lond. Math. Soc. (3) 110 (2015), no. 5,
1099&ndash;1134.
(<a href="https://torossmann.github.io//files/topzeta.pdf">preprint</a>)
</p>
<p><a name="topzeta2" id="topzeta2">[2]</a> T. Rossmann.
<a href="http://dx.doi.org/10.1016/j.jalgebra.2015.07.039"><i>Computing topological zeta functions of groups, algebras, and
modules, II</i></a>.
J.&nbsp;Algebra 444 (2015), 567&ndash;605.
(<a href="https://torossmann.github.io//files/topzeta2.pdf">preprint</a>)</p>
<p><a name="unipotent" id="unipotent">[3]</a> T. Rossmann.
<a href="http://dx.doi.org/10.1016/j.jalgebra.2015.09.050"><i>Topological representation zeta functions of unipotent groups</i></a>.
J.&nbsp;Algebra 448 (2016), 210&ndash;237.
(<a href="https://torossmann.github.io//files/unipotent.pdf">preprint</a>)</p>
<p><a name="padzeta" id="padzeta">[4]</a> T. Rossmann.
<a href="https://doi.org/10.1090/tran/7361"><i>Computing local zeta functions of groups, algebras, and modules</i></a>.
    Trans. Amer. Math. Soc. 370 (2018), no. 7, 4841&ndash;4879.
    (<a href="https://torossmann.github.io//files/padzeta.pdf">preprint</a>)</p>

<p><a name="ask" id="ask">[5]</a> T. Rossmann.
  <a href="https://doi.org/10.1112/plms.12159"><i>The average size of the kernel of a matrix and orbits of linear groups</i></a>.
  Proc. Lond. Math. Soc. (3) 117 (2018), no. 3, 574&ndash;616.
  (<a href="files/ask.pdf">preprint</a>)</p>

<p><a name="ask2" id="ask2">[6]</a> T. Rossmann.
  <a href="https://doi.org/10.1016/j.jpaa.2019.106203"><i>The average size of
    the kernel of a matrix and orbits of linear groups, II: duality</i></a>.
  J. Pure Appl. Algebra. (2019).
  (<a href="https://torossmann.github.io//files/ask2.pdf">preprint</a>)</p>
<p><a name="cico" id="cico">[7]</a> T. Rossmann and C. Voll.
  <i>Groups, graphs, and hypergraphs: average sizes of kernels of generic
    matrices with support constraints</i>.
  To appear in  Mem. Amer. Math. Soc.
  (<a href="https://torossmann.github.io//files/cico.pdf">preprint</a>)</p>

<!--====================================================================-->
<h1 id="funding">7. Funding</h1>
<!--====================================================================-->

<p>The development of Zeta work was supported by
    the <a href="https://www.humboldt-foundation.de">Alexander von
    Humboldt Foundation</a> (2016&ndash;2018)
  and by the <a href="http://www.dfg.de">DFG</a>
  Priority Programme &ldquo;<a href="https://spp.computeralgebra.de">Algorithmic and
  Experimental Methods in Algebra, Geometry and Number Theory</a>&rdquo;
  (2013&ndash;2016).
</p>


<!--====================================================================-->
<h1 id="acknowledgements">8. Acknowledgements</h1>
<!--====================================================================-->
<p>
  I am grateful to
  <a href="https://irma.math.unistra.fr/~chapoton/">Fr&eacute;d&eacute;ric
    Chapoton</a>
  for help with getting Zeta to work with SageMath 9.x.
</p>

<!--====================================================================-->
<h1 id="license">9. License</h1>
<!--====================================================================-->
<p>Copyright &copy; 2014, 2015, 2016, 2017, 2019, 2021, 2022 Tobias Rossmann.</p>
<p>Zeta is free software: you can redistribute it and/or modify it
under the terms of the <a href=
"http://www.gnu.org/copyleft/gpl.html">GNU General Public
License</a> as published by the Free Software Foundation, either
version 3 of the License, or (at your option) any later
version.</p>
<p>Zeta is distributed in the hope that it will be useful, but
without any warranty; without even the implied warranty of
merchantability or fitness for a particular purpose. See the GNU
General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public
License along with Zeta. If not, see <a href=
"http://www.gnu.org/licenses">http://www.gnu.org/licenses</a>.</p>
<!--====================================================================-->
<h1 id="contact">10. Contact</h1>
<!--====================================================================-->
<blockquote>Tobias Rossmann<br>
School of Mathematical and Statistical Sciences<br>
National University of Ireland, Galway<br>
Galway<br>
H91 TK33<br>
Ireland<br>
<br>
E-mail: tobias.rossmann (at) nuigalway.ie</blockquote>
<hr>
<small>last modified: 1 February 2022</small>
</body>
</html>
